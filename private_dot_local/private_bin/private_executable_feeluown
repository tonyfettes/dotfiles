#!/bin/bash

(exec bwrap \
  --symlink usr/lib /lib \
  --symlink usr/lib64 /lib64 \
  --ro-bind /usr/lib /usr/lib \
  --ro-bind /usr/lib64 /usr/lib64 \
  --ro-bind /usr/bin /usr/bin \
  --ro-bind /usr/share/X11/xkb /usr/share/X11/xkb \
  --ro-bind /usr/share/fonts /usr/share/fonts \
  --ro-bind /usr/share/glvnd /usr/share/glvnd \
  --ro-bind /usr/share/alsa /usr/share/alsa \
  --ro-bind /usr/share /usr/share \
  --ro-bind /etc/fonts /etc/fonts \
  --ro-bind /etc/hosts /etc/hosts \
  --ro-bind /etc/resolv.conf /etc/resolv.conf \
  --ro-bind /etc/group /etc/group \
  --ro-bind /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/ca-certificates.crt \
  --dir /run/user/"$(id -u)" \
  --ro-bind /run/user/"$(id -u)"/bus /run/user/"$(id -u)"/bus \
  --ro-bind /run/user/"$(id -u)"/pulse /run/user/"$(id -u)"/pulse \
  --ro-bind /run/user/"$(id -u)"/wayland-0 /run/user/"$(id -u)"/wayland-0 \
  --dev /dev \
  --dev-bind /dev/snd /dev/snd \
  --dev-bind /dev/dri /dev/dri \
  --ro-bind /sys /sys \
  --proc /proc \
  --tmpfs /tmp \
  --bind /home/tonyfettes/.cache/feeluown /home/tonyfettes/.FeelUOwn/cache \
  --bind /home/tonyfettes/.local/share/feeluown /home/tonyfettes/.FeelUOwn \
  --ro-bind /home/tonyfettes/.config/qt5ct /home/tonyfettes/.config/qt5ct \
  --ro-bind /home/tonyfettes/.config/Kvantum /home/tonyfettes/.config/Kvantum \
  --ro-bind /home/tonyfettes/.config/fontconfig /home/tonyfettes/.config/fontconfig \
  --ro-bind /home/tonyfettes/.icons /home/tonyfettes/.icons \
  --ro-bind /home/tonyfettes/.config/fcitx5 /home/tonyfettes/.config/fcitx5 \
  --ro-bind /home/tonyfettes/.local/share/fcitx5 /home/tonyfettes/.local/share/fcitx5 \
  --unshare-all \
  --share-net \
  --setenv PATH /usr/bin \
  --setenv MPV_DYLIB_PATH libmpv.so \
  --die-with-parent \
  --new-session \
  /usr/bin/feeluown "$@")
